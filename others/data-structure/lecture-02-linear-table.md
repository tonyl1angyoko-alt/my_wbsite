---
description: ç¬¬2ç«  çº¿æ€§è¡¨
---

# Lecture 02---linear table

## çº¿æ€§è¡¨çš„åŸºç¡€

### çº¿æ€§è¡¨çš„åŸºæœ¬è¿ç®—: æ„å»ºã€å±æ€§ã€éå†ç±»&#xD;

æ„å»ºç±»è¿ç®—\
**åˆ›å»ºä¸€ä¸ªç©ºçš„çº¿æ€§è¡¨**\
**æ¸…é™¤çº¿æ€§è¡¨**\
`virtual void clear() = 0;`\
è¿™æ˜¯ä¸€ä¸ªæŠ½è±¡åŸºç±» (Abstract Base Class, ABC)ï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ªâ€œçº¿æ€§è¡¨â€çš„æ¥å£ï¼ˆInterfaceï¼‰ã€‚

* ä»€ä¹ˆæ˜¯æ¥å£ï¼Ÿ å®ƒåªè§„å®šä¸€ä¸ªâ€œçº¿æ€§è¡¨â€å¿…é¡»èƒ½åšä»€ä¹ˆï¼ˆæ¯”å¦‚`clear`, `length`ï¼‰ï¼Œä½†å®Œå…¨ä¸ç®¡å®ƒå…·ä½“æ€ä¹ˆåšï¼ˆæ˜¯ç”¨æ•°ç»„è¿˜æ˜¯ç”¨é“¾è¡¨ï¼‰ã€‚
* å…³é”®ç‚¹ï¼š æ³¨æ„æ‰€æœ‰å‡½æ•°éƒ½ä»¥ `virtual ... = 0;` ç»“å°¾ã€‚
  * `virtual` å…³é”®å­—æ˜¯å®ç°å¤šæ€çš„åŸºç¡€ï¼Œå®ƒå‘Šè¯‰ç¼–è¯‘å™¨ï¼šè¿™ä¸ªå‡½æ•°çš„æœ€ç»ˆå®ç°è¦åˆ°å­ç±»ï¼ˆæ´¾ç”Ÿç±»ï¼‰é‡Œå»æ‰¾ã€‚
  * `= 0` æ˜¯C++çš„ç²¾é«“ä¹‹ä¸€ï¼Œå®ƒå£°æ˜è¿™æ˜¯ä¸€ä¸ªçº¯è™šå‡½æ•° (Pure Virtual Function)ã€‚
  * é‡éš¾ç‚¹ï¼š ä»»ä½•åŒ…å«çº¯è™šå‡½æ•°çš„ç±»ï¼ˆæ¯”å¦‚ä½ è¿™ä¸ª`linearList`ç±»ï¼‰éƒ½æ˜¯æŠ½è±¡ç±»ã€‚ä½ ä¸èƒ½ç›´æ¥åˆ›å»ºå®ƒçš„å®ä¾‹ï¼ˆæ¯”å¦‚ `linearList<int> myList;` ä¼šç¼–è¯‘å¤±è´¥ï¼‰ï¼Œä½ åªèƒ½åˆ›å»ºå®ƒâ€œå…·ä½“å­ç±»â€çš„å®ä¾‹ï¼ˆæ¯”å¦‚ `sequentialList<int> myList;` æˆ– `linkedList<int> myList;`ï¼Œå‰ææ˜¯è¿™äº›å­ç±»å®ç°äº†æ‰€æœ‰çº¯è™šå‡½æ•°ï¼‰ã€‚

è¿™å¥—è®¾è®¡ï¼Œå°±æ˜¯å¼ºè¿«æ‰€æœ‰â€œè‡ªç§°â€æ˜¯`linearList`çš„å­ç±»ï¼Œéƒ½å¿…é¡»æä¾›è¿™ä¸€æ•´å¥—æ ‡å‡†æœåŠ¡

å±æ€§ç±»è¿ç®—\
**è·å–è¡¨é•¿ğ‘›**\
`virtual int length() const = 0;`

`const` (é‡éš¾ç‚¹)ï¼š è¿™æ˜¯æœ¬è¡Œæœ€é‡è¦çš„å…³é”®å­—ã€‚

* å®ƒæ‰¿è¯ºï¼šè°ƒç”¨ `length()` å‡½æ•° ç»ä¸ä¼šä¿®æ”¹ çº¿æ€§è¡¨å¯¹è±¡å†…éƒ¨çš„ä»»ä½•æ•°æ®ã€‚å®ƒæ˜¯ä¸€ä¸ªåªè¯» (read-only) æ“ä½œã€‚
* ä¸ºä»€ä¹ˆé‡è¦ï¼Ÿ è¿™å…è®¸ä½ å¯¹ä¸€ä¸ª `const`ï¼ˆå¸¸é‡ï¼‰çº¿æ€§è¡¨å¯¹è±¡è°ƒç”¨ `length()`ã€‚å¦‚æœä½ ä¸åŠ  `const`ï¼Œç¼–è¯‘å™¨ä¼šç¦æ­¢ `const` å¯¹è±¡è°ƒç”¨å®ƒï¼Œå› ä¸ºç¼–è¯‘å™¨æ‹…å¿ƒè¿™ä¸ªå‡½æ•°ä¼šâ€œå·å·â€ä¿®æ”¹æ•°æ®ã€‚
* å®ç°ï¼š åœ¨å­ç±»ä¸­ï¼Œå®ƒå¯èƒ½åªæ˜¯ `return currentLength;` æˆ– `return size;`

\
**è®¿é—®å…ƒç´ **: è·å–çº¿æ€§è¡¨ä¸­ğ‘–,(0â‰¤ğ‘–â‰¤ğ‘›âˆ’1)ä½ç½®ä¸Šçš„æ•°æ®å…ƒç´ çš„å€¼\
`virtual elemType visit(int i) const = 0;`\


éå†ç±»è¿ç®—\
**æŒ‰ä½ç½®ä»å°åˆ°å¤§é¡ºåºå¯¹çº¿æ€§è¡¨ä¸­æ¯ä¸ªå…ƒç´ è®¿é—®ä¸”ä»…è®¿é—®ä¸€æ¬¡**\
`virtual void traverse(void (*touch)(const elemType &x)) const = 0;`

* ç¼ºç‚¹ï¼š å¦‚æœ `elemType` æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„å¯¹è±¡ï¼ˆæ¯”å¦‚ä¸€ä¸ªå¤æ‚çš„ `struct` æˆ– `string`ï¼‰ï¼Œåˆ›å»ºå‰¯æœ¬çš„å¼€é”€ä¼šå¾ˆå¤§ã€‚
* å¯¹æ¯”ï¼š å¦ä¸€ç§å¸¸è§è®¾è®¡æ˜¯ `virtual const elemType& visit(int i) const = 0;` ï¼ˆè¿”å›å¸¸é‡å¼•ç”¨ï¼‰ï¼Œè¿™æ ·å¯ä»¥é¿å…å¤åˆ¶ï¼Œæé«˜æ•ˆç‡ï¼ŒåŒæ—¶ `const` ä¿è¯äº†è°ƒç”¨è€…ä¹Ÿä¸èƒ½ä¿®æ”¹å®ƒã€‚



### çº¿æ€§è¡¨çš„åŸºæœ¬è¿ç®—: æ•°æ®æ“çºµç±»

æ’å…¥å…ƒç´ ğ‘¥ä½¿å…¶æˆä¸ºğ‘–,(0â‰¤ğ‘–â‰¤ğ‘›)ä½ç½®ä¸Šçš„æ•°æ®å…ƒç´ \
`virtual void insert(int i, const elemType &x) = 0;`

åˆ é™¤ğ‘–,(0 â‰¤ğ‘– â‰¤ğ‘›âˆ’1)ä½ç½®ä¸Šçš„æ•°æ®å…ƒç´ \
`virtual void remove(int i) = 0;`

å°†ğ‘–,(0 â‰¤ ğ‘– â‰¤ğ‘›âˆ’1)ä½ç½®ä¸Šçš„æ•°æ®å…ƒç´ çš„å€¼ä¿®æ”¹æˆğ‘¥\
`virtual void update(int i, const elemType &x) = 0;`

ä»ä½ç½®ğ‘–,(0â‰¤ğ‘– â‰¤ğ‘›âˆ’1)å¼€å§‹æŸ¥æ‰¾æ•°æ®å…ƒç´ ğ‘¥\
`virtual int search(const elemType &x, int i = 0) const = 0;`

```
#ifndef LIST_H_INCLUDED
#define LIST_H_INCLUDED

template <class elemType>
class list
{
public:
    class listError{};
public:
    virtual ~list(){}
    virtual void clear()=0;
    virtual int length() const=0;
    virtual elemType visit(int i) const=0;
    virtual void traverse(void(*touch)(const elemType &x)) const=0;
    virtual void insert(int i, const elemType &x) =0;
    virtual void remove(int i)=0;
    virtual void update(int i, const elemType &x) =0;
    virtual int search(const elemType &x, int i = 0) const =0;
};

#endif //LIST_H_INCLUDED
```

**å¼‚å¸¸ç±» (Exception Class)**

* `class listError{};` (ç¬¬8è¡Œ)
  * åˆ†æï¼šè¿™æ˜¯ä¸€ä¸ªâ€œæ ‡è®°ç±»â€ (Marker Class)ï¼Œç”¨äºå¼‚å¸¸å¤„ç†ã€‚
  * çœ¼å‰ä¸€äº®ï¼šè¿™ä¸ªç±»æœ¬èº«æ˜¯ç©ºçš„ï¼Œä½†å®ƒçš„ç±»å‹å°±æ˜¯å®ƒçš„ä¿¡æ¯ã€‚å½“å­ç±»ï¼ˆæ¯”å¦‚ `visit` æˆ– `remove`ï¼‰å‘ç°ä¸€ä¸ªé”™è¯¯ï¼ˆå¦‚ç´¢å¼•è¶Šç•Œï¼‰ï¼Œå®ƒå°±å¯ä»¥ `throw listError();` æ¥æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚
  * è°ƒç”¨è€…å¯ä»¥é€šè¿‡ `catch(const list<elemType>::listError& e)` æ¥æ•è·è¿™ç§ç‰¹å®šäº `list` çš„é”™è¯¯ï¼Œä»è€Œåšå‡ºç›¸åº”å¤„ç†ã€‚è¿™æ˜¯ä¸€ç§ç®€å•ä½†æœ‰æ•ˆçš„å¼‚å¸¸æœºåˆ¶ã€‚

**ææ„å‡½æ•° (Destructor)**

* `virtual ~list(){}` (ç¬¬10è¡Œ)
  * åˆ†æï¼šè¿™æ˜¯æœ¬é¡µPPTä¸­é‡éš¾ç‚¹ä¹‹ä¸€ï¼šè™šææ„å‡½æ•° (Virtual Destructor)ã€‚
  *   ä¸ºä»€ä¹ˆå¿…é¡»ï¼Ÿ å› ä¸ºè¿™ä¸ªç±»æ˜¯ç”¨æ¥å®ç°å¤šæ€çš„ã€‚ä½ å¾ˆå¯èƒ½ä¼šå†™å‡ºè¿™æ ·çš„ä»£ç ï¼š

      C++

      ```
      // åŸºç±»æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªå­ç±»å¯¹è±¡
      list<int>* myList = new sequentialList<int>(); 
      // ... ä½¿ç”¨ myList ...

      // å…³é”®åœ¨è¿™é‡Œï¼
      delete myList; 
      ```
  * é‡éš¾ç‚¹ï¼šå¦‚æœæ²¡æœ‰ `virtual` å…³é”®å­—ï¼Œ`delete myList;` åªä¼šè°ƒç”¨åŸºç±» `list` çš„ææ„å‡½æ•°ã€‚å­ç±» `sequentialList` ç”¨æ¥é‡Šæ”¾å†…å­˜ï¼ˆæ¯”å¦‚ `delete[] data`ï¼‰çš„ææ„å‡½æ•°å°†æ°¸è¿œä¸ä¼šè¢«è°ƒç”¨ï¼Œå¯¼è‡´ç¾éš¾æ€§çš„å†…å­˜æ³„æ¼ (Memory Leak)ï¼
  * ç»“è®ºï¼šåŠ ä¸Š `virtual`ï¼ŒC++ä¼šç¡®ä¿åœ¨ `delete` åŸºç±»æŒ‡é’ˆæ—¶ï¼Œå…ˆæ­£ç¡®è°ƒç”¨å­ç±»çš„ææ„å‡½æ•°ï¼Œå†è°ƒç”¨åŸºç±»çš„ã€‚è¿™é‡Œçš„ç©º`{}`å®ç°æ˜¯è¯´ï¼šåŸºç±»è‡ªå·±æ²¡ä»€ä¹ˆè¦æ¸…ç†çš„ï¼Œä½†å®ƒä¸ºæ‰€æœ‰å­ç±»â€œæ‰“å¼€äº†â€æ­£ç¡®ææ„çš„å¤§é—¨ã€‚

**åœ¨è°ƒç”¨çš„æ—¶å€™ï¼Œè¿™æ ·ç»™å‡º**

`#include "list.h"`\


`template <class elemType>`&#x20;

\
`class seqList : public list<elemType>`

åªæœ‰ç»§æ‰¿çš„å­ç±»å¯ä»¥å®ä¾‹åŒ–



### é¡ºåºè¡¨åŸºæœ¬è¿ç®—çš„å®ç°-æ„å»ºç±»

```cpp
template<typename elemType>
seqList<elemType>::seqList(int initSize){
    if (0 >= initSize)
        initSize = 8;

    elemArray = new elemType[initSize];
    maxSize = initSize;
    elemNum = 0;
}

template<typename elemType>
seqList<elemType>::~seqList(){
    delete []elemArray;
}

template<typename elemType>
void seqList<elemType>::clear(){
    elemNum = 0;
}
```
